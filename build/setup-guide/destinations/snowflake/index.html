<!doctype html>
<html lang="en-GB" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-setup-guide/destinations/snowflake">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Snowflake | Daspire</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.daspire.com/setup-guide/destinations/snowflake"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Snowflake | Daspire"><meta data-rh="true" name="description" content="This page contains the setup guide and reference information for Snowflake."><meta data-rh="true" property="og:description" content="This page contains the setup guide and reference information for Snowflake."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.daspire.com/setup-guide/destinations/snowflake"><link data-rh="true" rel="alternate" href="https://docs.daspire.com/setup-guide/destinations/snowflake" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://docs.daspire.com/zh/setup-guide/destinations/snowflake" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://docs.daspire.com/setup-guide/destinations/snowflake" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.9f0b871e.css">
<link rel="preload" href="/assets/js/runtime~main.aefa0c03.js" as="script">
<link rel="preload" href="/assets/js/main.368c731d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-dark.png" alt="Daspire logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo-dark.png" alt="Daspire logo" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/setup-guide/destinations/snowflake" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en-GB">English</a></li><li><a href="/zh/setup-guide/destinations/snowflake" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-CN">中文</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Start here</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/key-concepts">Key concepts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/setup-guide/sources/amazon-ads">Setup guide</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/setup-guide/sources/amazon-ads">Sources</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/setup-guide/destinations/bigquery">Destinations</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/setup-guide/destinations/bigquery">BigQuery</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/setup-guide/destinations/mysql">MySQL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/setup-guide/destinations/redshift">Redshift</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/setup-guide/destinations/snowflake">Snowflake</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/configurations">Configurations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sync-log">Sync log</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Setup guide</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Destinations</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Snowflake</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Snowflake</h1><p>This page contains the setup guide and reference information for Snowflake.</p><p>Setting up Snowflake as a destination involves setting up Snowflake entities (warehouse, database, schema, user, and role) in the Snowflake console, setting up the data loading method (internal stage, AWS S3, Google Cloud Storage bucket, or Azure Blob Storage), and configuring the Snowflake destination inside Daspire.</p><p>This page describes the step-by-step process of setting up Snowflake as a destination.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">​</a></h2><ul><li><p>A Snowflake account with the <a href="https://docs.snowflake.com/en/user-guide/security-access-control-considerations.html" target="_blank" rel="noopener noreferrer">ACCOUNTADMIN</a> role. If you don&#x27;t have an account with the ACCOUNTADMIN role, contact your Snowflake administrator to set one up for you.</p></li><li><p>(Optional) An AWS, Google Cloud Storage, or Azure account.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="network-policies">Network policies<a class="hash-link" href="#network-policies" title="Direct link to heading">​</a></h2><p>By default, Snowflake allows users to connect to the service from any computer or device IP address. A security administrator (i.e. users with the SECURITYADMIN role) or higher can create a network policy to allow or deny access to a single IP address or a list of addresses.</p><p>If you have any issues connecting with Daspire, please make sure that the list of IP addresses is on the allowed list.</p><p>To determine whether a network policy is set on your account or for a specific user, execute the SHOW PARAMETERS command.</p><p><strong>Account</strong></p><p><code>SHOW PARAMETERS LIKE &#x27;network_policy&#x27; IN ACCOUNT;</code></p><p><strong>User</strong></p><p><code>SHOW PARAMETERS LIKE &#x27;network_policy&#x27; IN USER &lt;username&gt;;</code></p><p>To read more please check official <a href="https://docs.snowflake.com/en/user-guide/network-policies.html#" target="_blank" rel="noopener noreferrer">Snowflake documentation</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="setup-guide">Setup guide<a class="hash-link" href="#setup-guide" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-set-up-daspire-specific-entities-in-snowflake">Step 1: Set up Daspire-specific entities in Snowflake<a class="hash-link" href="#step-1-set-up-daspire-specific-entities-in-snowflake" title="Direct link to heading">​</a></h3><p>To set up the Snowflake destination connector, you first need to create Daspire-specific Snowflake entities (a warehouse, database, schema, user, and role) with the OWNERSHIP permission to write data into Snowflake, track costs pertaining to Daspire, and control permissions at a granular level.</p><p>You can use the following script in a new <a href="https://docs.snowflake.com/en/user-guide/ui-worksheet.html" target="_blank" rel="noopener noreferrer">Snowflake worksheet</a> to create the entities:</p><ol><li><p><a href="https://www.snowflake.com/login/" target="_blank" rel="noopener noreferrer">Log into your Snowflake account</a>.</p></li><li><p>Edit the following script to change the password to a more secure password and to change the names of other resources if you so desire.</p><blockquote><p><strong>Note:</strong> Make sure you follow the <a href="https://docs.snowflake.com/en/sql-reference/identifiers-syntax.html" target="_blank" rel="noopener noreferrer">Snowflake identifier requirements</a> while renaming the resources.</p></blockquote></li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> set variables (these need to be uppercase)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> set daspire_role = &#x27;DASPIRE_ROLE&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> set daspire_username = &#x27;DASPIRE_USER&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> set daspire_warehouse = &#x27;DASPIRE_WAREHOUSE&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> set daspire_database = &#x27;DASPIRE_DATABASE&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> set daspire_schema = &#x27;DASPIRE_SCHEMA&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -- set user password</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> set daspire_password = &#x27;password&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> begin;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -- create Daspire role</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> use role securityadmin;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> create role if not exists identifier($daspire_role);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> grant role identifier($daspire_role) to role SYSADMIN;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -- create Daspire user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> create user if not exists identifier($daspire_username)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> password = $daspire_password</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> default_role = $daspire_role</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> default_warehouse = $daspire_warehouse;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> grant role identifier($daspire_role) to user identifier($daspire_username);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -- change role to sysadmin for warehouse / database steps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> use role sysadmin;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -- create Daspire warehouse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> create warehouse if not exists identifier($daspire_warehouse)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> warehouse_size = xsmall</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> warehouse_type = standard</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> auto_suspend = 60</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> auto_resume = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> initially_suspended = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -- create Daspire database</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> create database if not exists identifier($daspire_database);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -- grant Daspire warehouse access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> grant USAGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> on warehouse identifier($daspire_warehouse)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> to role identifier($daspire_role);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -- grant Daspire database access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> grant OWNERSHIP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> on database identifier($daspire_database)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> to role identifier($daspire_role);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> commit;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> begin;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> USE DATABASE identifier($daspire_database);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -- create schema for Daspire data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> CREATE SCHEMA IF NOT EXISTS identifier($daspire_schema);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> commit;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> begin;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -- grant Daspire schema access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> grant OWNERSHIP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> on schema identifier($daspire_schema)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> to role identifier($daspire_role);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> commit;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>Run the script using the <a href="https://docs.snowflake.com/en/user-guide/ui-worksheet.html" target="_blank" rel="noopener noreferrer">Worksheet page</a> or <a href="https://docs.snowflake.com/en/user-guide/ui-snowsight-gs.html" target="_blank" rel="noopener noreferrer">Snowlight</a>. Make sure to select the <strong>All Queries</strong> checkbox.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-set-up-a-data-loading-method">Step 2: Set up a data loading method<a class="hash-link" href="#step-2-set-up-a-data-loading-method" title="Direct link to heading">​</a></h3><p>By default, Daspire uses Snowflake&#x27;s <a href="https://docs.snowflake.com/en/user-guide/data-load-local-file-system-create-stage.html" target="_blank" rel="noopener noreferrer">Internal Stage</a> to load data. You can also load data using an <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/Welcome.html" target="_blank" rel="noopener noreferrer">Amazon S3 bucket</a>, a <a href="https://cloud.google.com/storage/docs/introduction" target="_blank" rel="noopener noreferrer">Google Cloud Storage bucket</a>, or <a href="https://docs.microsoft.com/en-us/azure/storage/blobs/" target="_blank" rel="noopener noreferrer">Azure Blob Storage</a>.</p><p>Make sure the database and schema have the USAGE privilege.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-an-amazon-s3-bucket">Using an Amazon S3 bucket<a class="hash-link" href="#using-an-amazon-s3-bucket" title="Direct link to heading">​</a></h4><p>To use an Amazon S3 bucket, <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/create-bucket-overview.html" target="_blank" rel="noopener noreferrer">create a new Amazon S3 bucket</a> with read/write access for Daspire to stage data to Snowflake.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-a-google-cloud-storage-bucket">Using a Google Cloud Storage bucket<a class="hash-link" href="#using-a-google-cloud-storage-bucket" title="Direct link to heading">​</a></h4><p>To use a Google Cloud Storage bucket:</p><ol><li><p>Navigate to the Google Cloud Console and <a href="https://cloud.google.com/storage/docs/creating-buckets" target="_blank" rel="noopener noreferrer">create a new bucket</a> with read/write access for Daspire to stage data to Snowflake.</p></li><li><p><a href="https://cloud.google.com/iam/docs/creating-managing-service-account-keys#creating_service_account_keys" target="_blank" rel="noopener noreferrer">Generate a JSON key</a> for your service account.</p></li><li><p>Edit the following script to replace DASPIRE<!-- -->_<!-- -->ROLE with the role you used for Daspire&#x27;s Snowflake configuration and YOURBUCKETNAME with your bucket name.</p></li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> create storage INTEGRATION gcs_daspire_integration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> TYPE = EXTERNAL_STAGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> STORAGE_PROVIDER = GCS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ENABLED = TRUE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> STORAGE_ALLOWED_LOCATIONS = (&#x27;gcs://YOURBUCKETNAME&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> create stage gcs_daspire_stage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> url = &#x27;gcs://YOURBUCKETNAME&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> storage_integration = gcs_daspire_integration;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> GRANT USAGE ON integration gcs_daspire_integration TO ROLE DASPIRE_ROLE;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> GRANT USAGE ON stage gcs_daspire_stage TO ROLE DASPIRE_ROLE;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> DESC STORAGE INTEGRATION gcs_daspire_integration;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="4"><li><p>The final query should show a <code>STORAGE_GCP_SERVICE_ACCOUNT</code> property with an email as the property value. Add read/write permissions to your bucket with that email.</p></li><li><p>Navigate to the Snowflake UI and run the script as a <a href="https://docs.snowflake.com/en/user-guide/security-access-control-considerations.html" target="_blank" rel="noopener noreferrer">Snowflake account admin</a> using the <a href="https://docs.snowflake.com/en/user-guide/ui-worksheet.html" target="_blank" rel="noopener noreferrer">Worksheet page</a> or <a href="https://docs.snowflake.com/en/user-guide/ui-snowsight-gs.html" target="_blank" rel="noopener noreferrer">Snowlight</a>.</p></li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-azure-blob-storage">Using Azure Blob Storage<a class="hash-link" href="#using-azure-blob-storage" title="Direct link to heading">​</a></h4><p>To use Azure Blob Storage, <a href="https://docs.microsoft.com/en-us/azure/storage/common/storage-account-create?tabs=azure-portal" target="_blank" rel="noopener noreferrer">create a storage account</a> and <a href="https://docs.microsoft.com/en-us/rest/api/storageservices/create-container" target="_blank" rel="noopener noreferrer">container</a>, and provide a <a href="https://docs.snowflake.com/en/user-guide/data-load-azure-config.html#option-2-generating-a-sas-token" target="_blank" rel="noopener noreferrer">SAS Token</a> to access the container. We recommend creating a dedicated container for Daspire to stage data to Snowflake. Daspire needs read/write access to interact with this container.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-set-up-snowflake-as-a-destination-in-daspire">Step 3: Set up Snowflake as a destination in Daspire<a class="hash-link" href="#step-3-set-up-snowflake-as-a-destination-in-daspire" title="Direct link to heading">​</a></h3><p>Navigate to the Daspire to set up Snowflake as a destination. You can authenticate using username/password or OAuth 2.0:</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="username-and-password">Username and Password<a class="hash-link" href="#username-and-password" title="Direct link to heading">​</a></h4><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td>Host</td><td>The host domain of the snowflake instance (must include the account, region, cloud environment, and end with snowflakecomputing.com). Example: accountname.us-east-2.aws.snowflakecomputing.com</td></tr><tr><td>Role</td><td>The role you created in Step 1 for Daspire to access Snowflake. Example: DASPIRE<!-- -->_<!-- -->ROLE</td></tr><tr><td>Warehouse</td><td>The warehouse you created in Step 1 for Daspire to sync data into. Example: DASPIRE<!-- -->_<!-- -->WAREHOUSE</td></tr><tr><td>Database</td><td>The database you created in Step 1 for Daspire to sync data into. Example: DASPIRE<!-- -->_<!-- -->DATABASE</td></tr><tr><td>Schema</td><td>The default schema used as the target schema for all statements issued from the connection that do not explicitly specify a schema name.</td></tr><tr><td>Username</td><td>The username you created in Step 1 to allow Daspire to access the database. Example: DASPIRE<!-- -->_<!-- -->USER</td></tr><tr><td>Password</td><td>The password associated with the username.</td></tr><tr><td>JDBC URL Params (optional)</td><td>Additional properties to pass to the JDBC URL string when connecting to the database formatted as key=value pairs separated by the symbol &amp;. Example: key1=value1&amp;key2=value2&amp;key3=value3</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="oauth-20">OAuth 2.0<a class="hash-link" href="#oauth-20" title="Direct link to heading">​</a></h4><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td>Host</td><td>The host domain of the snowflake instance (must include the account, region, cloud environment, and end with snowflakecomputing.com). Example: accountname.us-east-2.aws.snowflakecomputing.com</td></tr><tr><td>Role</td><td>The role you created in Step 1 for Daspire to access Snowflake. Example: DASPIRE<!-- -->_<!-- -->ROLE</td></tr><tr><td>Warehouse</td><td>The warehouse you created in Step 1 for Daspire to sync data into. Example: DASPIRE<!-- -->_<!-- -->WAREHOUSE</td></tr><tr><td>Database</td><td>The database you created in Step 1 for Daspire to sync data into. Example: DASPIRE<!-- -->_<!-- -->DATABASE</td></tr><tr><td>Schema</td><td>The default schema used as the target schema for all statements issued from the connection that do not explicitly specify a schema name.</td></tr><tr><td>Username</td><td>The username you created in Step 1 to allow Daspire to access the database. Example: DASPIRE<!-- -->_<!-- -->USER</td></tr><tr><td>OAuth2</td><td>The Login name and password to obtain auth token.</td></tr><tr><td>JDBC URL Params (optional)</td><td>Additional properties to pass to the JDBC URL string when connecting to the database formatted as key=value pairs separated by the symbol &amp;. Example: key1=value1&amp;key2=value2&amp;key3=value3</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="key-pair-authentication">Key pair authentication<a class="hash-link" href="#key-pair-authentication" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> In order to configure key pair authentication you will need a private/public key pair.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> If you do not have the key pair yet, you can generate one using openssl command line tool</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Use this command in order to generate an unencrypted private key file:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> `openssl genrsa 2048 | openssl pkcs8 -topk8 -inform PEM -out rsa_key.p8 -nocrypt`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Alternatively, use this command to generate an encrypted private key file:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> `openssl genrsa 2048 | openssl pkcs8 -topk8 -inform PEM -v1 PBE-SHA1-RC4-128 -out rsa_key.p8`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Once you have your private key, you need to generate a matching public key.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> You can do so with the following command:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> `openssl rsa -in rsa_key.p8 -pubout -out rsa_key.pub`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Finally, you need to add the public key to your Snowflake user account.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> You can do so with the following SQL command in Snowflake:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> `alter user &lt;user_name&gt; set rsa_public_key=&lt;public_key_value&gt;;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> and replace &lt;user_name&gt; with your user name and &lt;public_key_value&gt; with your public key. </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To use <strong>AWS S3</strong> as the cloud storage, enter the information for the S3 bucket you created in Step 2:</p><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td>S3 Bucket Name</td><td>The name of the staging S3 bucket (Example: daspire.staging). Daspire will write files to this bucket and read them via statements on Snowflake.</td></tr><tr><td>S3 Bucket Region</td><td>The S3 staging bucket region used.</td></tr><tr><td>S3 Key Id <!-- -->*</td><td>The Access Key ID granting access to the S3 staging bucket. Daspire requires Read and Write permissions for the bucket.</td></tr><tr><td>S3 Access Key <!-- -->*</td><td>The corresponding secret to the S3 Key ID.</td></tr><tr><td>Stream Part Size (optional)</td><td>Increase this if syncing tables larger than 100GB. Files are streamed to S3 in parts. This determines the size of each part, in MBs. As S3 has a limit of 10,000 parts per file, part size affects the table size. This is 10MB by default, resulting in a default limit of 100GB tables. Note, a larger part size will result in larger memory requirements. A rule of thumb is to multiply the part size by 10 to get the memory requirement. Modify this with care. (e.g. 5)</td></tr><tr><td>Purge Staging Files and Tables</td><td>Determines whether to delete the staging files from S3 after completing the sync. Specifically, the connector will create CSV files named bucketPath/namespace/streamName/syncDate<!-- -->_<!-- -->epochMillis<!-- -->_<!-- -->randomUuid.csv containing three columns (ab<!-- -->_<!-- -->id, data, emitted<!-- -->_<!-- -->at). Normally these files are deleted after sync; if you want to keep them for other purposes, set purge<!-- -->_<!-- -->staging<!-- -->_<!-- -->data to false.</td></tr><tr><td>Encryption</td><td>Whether files on S3 are encrypted. You probably don&#x27;t need to enable this, but it can provide an additional layer of security if you are sharing your data storage with other applications. If you do use encryption, you must choose between ephemeral keys (Daspire will automatically generate a new key for each sync, and nobody but Daspire and Snowflake will be able to read the data on S3) or providing your own key (if you have the &quot;Purge staging files and tables&quot; option disabled, and you want to be able to decrypt the data yourself)</td></tr><tr><td>S3 Filename pattern (optional)</td><td>The pattern allows you to set the file-name format for the S3 staging file(s), next placeholders combinations are currently supported: {date}, {date:yyyy<!-- -->_<!-- -->MM}, {timestamp}, {timestamp:millis}, {timestamp:micros}, {part<!-- -->_<!-- -->number}, {sync<!-- -->_<!-- -->id}, {format<!-- -->_<!-- -->extension}. Please, don&#x27;t use empty space and not supportable placeholders, as they won&#x27;t recognized.</td></tr></tbody></table><p>To use a <strong>Google Cloud Storage</strong> bucket, enter the information for the bucket you created in Step 2:</p><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td>GCP Project ID</td><td>The name of the GCP project ID for your credentials. (Example: my-project)</td></tr><tr><td>GCP Bucket Name</td><td>The name of the staging bucket. Daspire will write files to this bucket and read them via statements on Snowflake. (Example: daspire-staging)</td></tr><tr><td>Google Application Credentials</td><td>The contents of the JSON key file that has read/write permissions to the staging GCS bucket. You will separately need to grant bucket access to your Snowflake GCP service account. See the Google Cloud docs for more information on how to generate a JSON key for your service account.</td></tr></tbody></table><p>To use <strong>Azure Blob</strong> storage, enter the information for the storage you created in Step 2:</p><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td>Endpoint Domain Name</td><td>Leave default value blob.core.windows.net or map a custom domain to an Azure Blob Storage endpoint.</td></tr><tr><td>Azure Blob Storage Account Name</td><td>The Azure storage account you created in Step 2.</td></tr><tr><td>Azure Blob Storage Container (Bucket) Name</td><td>The Azure blob storage container you created in Step 2.</td></tr><tr><td>SAS Token</td><td>The SAS Token you provided in Step 2.</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="output-schema">Output schema<a class="hash-link" href="#output-schema" title="Direct link to heading">​</a></h2><p>Daspire outputs each stream into its own table with the following columns in Snowflake:</p><table><thead><tr><th>Daspire field</th><th>Description</th><th>Column type</th></tr></thead><tbody><tr><td>_<!-- -->daspire<!-- -->_<!-- -->ab<!-- -->_<!-- -->id</td><td>A UUID assigned to each processed event</td><td>VARCHAR</td></tr><tr><td>_<!-- -->daspire<!-- -->_<!-- -->emitted<!-- -->_<!-- -->at</td><td>A timestamp for when the event was pulled from the data source</td><td>TIMESTAMP WITH TIME ZONE</td></tr><tr><td>_<!-- -->daspire<!-- -->_<!-- -->data</td><td>A JSON blob with the event data.</td><td>VARIANT</td></tr></tbody></table><p><strong>Note:</strong> By default, Daspire creates permanent tables. If you prefer transient tables, create a dedicated transient database for Daspire. For more information, refer to <a href="https://docs.snowflake.com/en/user-guide/tables-temp-transient.html" target="_blank" rel="noopener noreferrer">Working with Temporary and Transient Tables</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="supported-sync-modes">Supported sync modes<a class="hash-link" href="#supported-sync-modes" title="Direct link to heading">​</a></h2><p>The Snowflake destination supports the following sync modes:</p><ul><li>Full Refresh - Overwrite</li><li>Full Refresh - Append</li><li>Incremental Sync - Append</li><li>Incremental Sync - Deduped History</li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/setup-guide/destinations/redshift"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Redshift</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/configurations"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Configurations</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#network-policies" class="table-of-contents__link toc-highlight">Network policies</a></li><li><a href="#setup-guide" class="table-of-contents__link toc-highlight">Setup guide</a><ul><li><a href="#step-1-set-up-daspire-specific-entities-in-snowflake" class="table-of-contents__link toc-highlight">Step 1: Set up Daspire-specific entities in Snowflake</a></li><li><a href="#step-2-set-up-a-data-loading-method" class="table-of-contents__link toc-highlight">Step 2: Set up a data loading method</a></li><li><a href="#step-3-set-up-snowflake-as-a-destination-in-daspire" class="table-of-contents__link toc-highlight">Step 3: Set up Snowflake as a destination in Daspire</a></li></ul></li><li><a href="#output-schema" class="table-of-contents__link toc-highlight">Output schema</a></li><li><a href="#supported-sync-modes" class="table-of-contents__link toc-highlight">Supported sync modes</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Sictec Infotech, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.aefa0c03.js"></script>
<script src="/assets/js/main.368c731d.js"></script>
</body>
</html>